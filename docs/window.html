<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />

    <link rel="shortcut icon" href="https://vega.github.io/favicon.ico" />

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Window | Vega-Lite</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Window" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Vega-Lite - a high-level grammar for statistical graphics. Vega-Lite provides a higher-level grammar for visual analysis, comparable to ggplot or Tableau, that generates complete Vega specifications. Vega-Lite specifications consist of simple mappings of variables in a data set to visual encoding channels such as x, y, color, and size. These mappings are then translated into detailed visualization specifications in the form of Vega specification language. Vega-Lite produces default values for visualization components (e.g., scales, axes, and legends) in the output Vega specification using a rule-based approach, but users can explicit specify these properties to override default values." />
<meta property="og:description" content="Vega-Lite - a high-level grammar for statistical graphics. Vega-Lite provides a higher-level grammar for visual analysis, comparable to ggplot or Tableau, that generates complete Vega specifications. Vega-Lite specifications consist of simple mappings of variables in a data set to visual encoding channels such as x, y, color, and size. These mappings are then translated into detailed visualization specifications in the form of Vega specification language. Vega-Lite produces default values for visualization components (e.g., scales, axes, and legends) in the output Vega specification using a rule-based approach, but users can explicit specify these properties to override default values." />
<meta property="og:site_name" content="Vega-Lite" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Window" />
<meta name="twitter:site" content="@vega_vis" />
<script type="application/ld+json">
{"headline":"Window","url":"/vega-lite/docs/window.html","@type":"WebPage","description":"Vega-Lite - a high-level grammar for statistical graphics. Vega-Lite provides a higher-level grammar for visual analysis, comparable to ggplot or Tableau, that generates complete Vega specifications. Vega-Lite specifications consist of simple mappings of variables in a data set to visual encoding channels such as x, y, color, and size. These mappings are then translated into detailed visualization specifications in the form of Vega specification language. Vega-Lite produces default values for visualization components (e.g., scales, axes, and legends) in the output Vega specification using a rule-based approach, but users can explicit specify these properties to override default values.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <script>
      const BASEURL = window.location.origin + '/vega-lite';
    </script>

    <link rel="stylesheet" href="/vega-lite/static/github.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/octicons@4.4.0/build/font/octicons.min.css" />
    <link rel="stylesheet" href="/vega-lite/static/main.css" />
  </head>
  <body>
    <div class="fill">
  <header>
    <nav class="page-centered">
      <div class="dropdown">
        <a class="vl-title" href="/vega-lite/">Vega-Lite</a>
        <div class="dropdown-content">
          <a href="https://vega.github.io/vega/">Vega</a>
          <a href="https://altair-viz.github.io/">Altair</a>
        </div>
      </div>
      <div class="vl-links">
        <div class="primary-links">
          <a href="/vega-lite/examples/" >Examples</a>
          <a href="/vega-lite/tutorials/getting_started.html" >Tutorials</a>
          <a href="/vega-lite/docs/" class="active">Documentation</a>
          <a href="/vega-lite/usage/embed.html" >Usage</a>
          <a href="/vega-lite/ecosystem.html" >Ecosystem</a>
        </div>
        <div class="secondary-links">
          <a href="https://www.github.com/vega/vega-lite">GitHub</a>
          <a href="https://vega.github.io/editor/#/custom/vega-lite">Try Online</a>
        </div>
      </div>
    </nav>
  </header>
  <section class="docs">
    



<div class="page-centered page-main">
  
  <aside class="page-sidebar">
    <ul class="sidebar-nav">
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/" title="">Overview
      </a></li>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/spec.html" title="">View Specification
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/title.html" title="">Title
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/size.html" title="">Width / Height
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/data.html" title="">Data / Datasets
      </a></li>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/transform.html" title="">Transform
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/aggregate.html" title="">Aggregate
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/bin.html" title="">Bin
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/calculate.html" title="">Calculate
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/density.html" title="">Density
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/filter.html" title="">Filter
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/flatten.html" title="">Flatten
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/fold.html" title="">Fold
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/impute.html" title="">Impute
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/joinaggregate.html" title="">Join Aggregate
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/loess.html" title="">Loess
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/lookup.html" title="">Lookup
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/pivot.html" title="">Pivot
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/quantile.html" title="">Quantile
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/regression.html" title="">Regression
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/sample.html" title="">Sample
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/stack.html" title="">Stack
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/timeunit.html" title="">Time Unit
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a class="active"
            href="/vega-lite/docs/window.html" title="">Window
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/mark.html" title="">Mark
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/arc.html" title="">Arc
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/area.html" title="">Area
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/bar.html" title="">Bar
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/boxplot.html" title="">Box Plot
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/circle.html" title="">Circle
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/errorband.html" title="">Error Band
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/errorbar.html" title="">Error Bar
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/geoshape.html" title="">Geoshape
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/image.html" title="">Image
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/line.html" title="">Line
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/point.html" title="">Point
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/rect.html" title="">Rect
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/rule.html" title="">Rule
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/square.html" title="">Square
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/text.html" title="">Text
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/tick.html" title="">Tick
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/trail.html" title="">Trail
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/encoding.html" title="">Encoding
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/aggregate.html" title="">Aggregate
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/axis.html" title="">Axis
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/band.html" title="">Band
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/bin.html" title="">Bin
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/condition.html" title="">Condition
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/datum.html" title="">Datum
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/field.html" title="">Field
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/format.html" title="">Format
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/header.html" title="">Header
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/impute.html" title="">Impute
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/legend.html" title="">Legend
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/scale.html" title="">Scale
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/stack.html" title="">Stack
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/sort.html" title="">Sort
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/timeunit.html" title="">Time Unit
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/type.html" title="">Type
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/value.html" title="">Value
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/projection.html" title="">Projection
      </a></li>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/composition.html" title="">View Composition
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/facet.html" title="">Facet
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/layer.html" title="">Layer
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/concat.html" title="">Concat
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/repeat.html" title="">Repeat
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/resolve.html" title="">Resolve
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/selection.html" title="">Selections
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/bind.html" title="">Bind
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/clear.html" title="">Clear
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/project.html" title="">Encodings / Fields
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/init.html" title="">Init
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/selection-mark.html" title="">Mark
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/nearest.html" title="">Nearest
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/selection-resolve.html" title="">Resolve
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/toggle.html" title="">Toggle
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/translate.html" title="">Translate
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/zoom.html" title="">Zoom
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/config.html" title="">Config
      </a></li>
      
      
      
      
      <br>
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/types.html" title="">Parameter Types
      </a></li>
      
      <ul class="sub-sub-nav">
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/datetime.html" title="">Date Time
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/gradient.html" title="">Gradient
        </a></li>
        
        <li class="sidebar-nav-item sub-item"><a 
            href="/vega-lite/docs/predicate.html" title="">Predicate
        </a></li>
        
      </ul>
      
      
      
      
      <li class="sidebar-nav-item"><a 
          href="/vega-lite/docs/tooltip.html" title="">Tooltip
      </a></li>
      
      
      
    </nav>
  </aside>
  

  <section class="page-content">
    <h1>Window</h1>
    <span class="edit-page">
    <a href="https://github.com/vega/vega-lite/edit/master/site/docs/transform/window.md">Edit this page</a>
</span>
<p>The window transform performs calculations over sorted groups of data objects. These calculations including ranking, lead/lag analysis, and aggregates such as running sums and averages. Calculated values are written back to the input data stream. If you only want to set the same aggregated value in a new field, you can use the simpler <a href="joinaggregate.html">join aggregate</a> transform.</p>

<!--prettier-ignore-start-->
<h2 class="no_toc" id="documentation-overview">Documentation Overview</h2>

<ul id="markdown-toc">
  <li><a href="#window-field-definition" id="markdown-toc-window-field-definition">Window Field Definition</a></li>
  <li><a href="#window-transform-definition" id="markdown-toc-window-transform-definition">Window Transform Definition</a>    <ul>
      <li><a href="#field-def" id="markdown-toc-field-def">Window Transform Field Definition</a></li>
      <li><a href="#sort-field-def" id="markdown-toc-sort-field-def">Sort Field Definition</a></li>
    </ul>
  </li>
  <li><a href="#ops" id="markdown-toc-ops">Window Only Operation Reference</a></li>
  <li><a href="#examples" id="markdown-toc-examples">Examples</a>    <ul>
      <li><a href="#cumulative-frequency-distribution" id="markdown-toc-cumulative-frequency-distribution">Cumulative Frequency Distribution</a></li>
      <li><a href="#rank-chart" id="markdown-toc-rank-chart">Rank Chart</a></li>
      <li><a href="#top-k" id="markdown-toc-top-k">Top K</a></li>
      <li><a href="#cumulative-running-average" id="markdown-toc-cumulative-running-average">Cumulative Running Average</a></li>
    </ul>
  </li>
  <li><a href="#additional-examples" id="markdown-toc-additional-examples">Additional Examples</a>    <ul>
      <li><a href="#percent-of-total" id="markdown-toc-percent-of-total">Percent of Total</a></li>
    </ul>
  </li>
</ul>

<!--prettier-ignore-end-->

<h2 id="window-field-definition">Window Field Definition</h2>

<pre><code class="language-js">// Any View Specification
{
  ...
  "transform": [
    {
      // Window Transform
      "window": [{
          "op": ...,
          "field": ...,
          "param": ...,
          "as": ...
      }],
      "sort": [
        {"field": ..., "order": ...}
      ],
      "ignorePeers": ...,
      "groupby": [
        "..."
      ],
      "frame": [...,...]
    }
     ...
  ],
  ...
}
</code></pre>

<h2 id="window-transform-definition">Window Transform Definition</h2>

<table class="doc-table">
  <thead>
    <tr>
      <th>Property</th>
      <th class="table-column-type">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    
    
    
    
      
      
      <tr>
        <td>window</td>
        <td><a href="window.html#field-def">WindowFieldDef</a>[]
</td>
        <td>
  
    <p><strong><em>Required.</em></strong> The definition of the fields in the window, and what calculations to use.</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>frame</td>
        <td>(Null | Number)[]
</td>
        <td>
  
    <p>A frame specification as a two-element array indicating how the sliding window should proceed. The array entries should either be a number indicating the offset from the current data object, or null to indicate unbounded rows preceding or following the current data object. The default value is <code>[null, 0]</code>, indicating that the sliding window includes the current object and all preceding objects. The value <code>[-5, 5]</code> indicates that the window should include five objects preceding and five objects following the current object. Finally, <code>[null, null]</code> indicates that the window frame should always include all data objects. If you this frame and want to assign the same value to add objects, you can use the simpler <a href="https://vega.github.io/vega-lite/docs/joinaggregate.html">join aggregate transform</a>. The only operators affected are the aggregation operations and the <code>first_value</code>, <code>last_value</code>, and <code>nth_value</code> window operations. The other window operations are not affected by this.</p>

<p><strong>Default value:</strong>:  <code>[null, 0]</code> (includes the current object and all preceding objects)</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>ignorePeers</td>
        <td>Boolean
</td>
        <td>
  
    <p>Indicates if the sliding window frame should ignore peer values (data that are considered identical by the sort criteria). The default is false, causing the window frame to expand to include all peer values. If set to true, the window frame will be defined by offset values only. This setting only affects those operations that depend on the window frame, namely aggregation operations and the first_value, last_value, and nth_value window operations.</p>

<p><strong>Default value:</strong> <code>false</code></p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>groupby</td>
        <td>String[]
</td>
        <td>
  
    <p>The data fields for partitioning the data objects into separate windows. If unspecified, all data points will be in a single window.</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>sort</td>
        <td><a href="window.html#sort-field-def">SortField</a>[]
</td>
        <td>
  
    <p>A sort field definition for sorting data objects within a window. If two data objects are considered equal by the comparator, they are considered “peer” values of equal rank. If sort is not specified, the order is undefined: data objects are processed in the order they are observed and none are considered peers (the ignorePeers parameter is ignored and treated as if set to <code>true</code>).</p>

  

</td>
      </tr>
    
  </tbody>
</table>

<h3 id="field-def">Window Transform Field Definition</h3>

<table class="doc-table">
  <thead>
    <tr>
      <th>Property</th>
      <th class="table-column-type">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    
    
    
    
      
      
      <tr>
        <td>op</td>
        <td>String | String
</td>
        <td>
  
    <p><strong><em>Required.</em></strong> The window or aggregation operation to apply within a window (e.g., <code>"rank"</code>, <code>"lead"</code>, <code>"sum"</code>, <code>"average"</code> or <code>"count"</code>). See the list of all supported operations <a href="https://vega.github.io/vega-lite/docs/window.html#ops">here</a>.</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>param</td>
        <td>Number
</td>
        <td>
  
    <p>Parameter values for the window functions. Parameter values can be omitted for operations that do not accept a parameter.</p>

<p>See the list of all supported operations and their parameters <a href="https://vega.github.io/vega-lite/docs/transforms/window.html">here</a>.</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>field</td>
        <td>String
</td>
        <td>
  
    <p>The data field for which to compute the aggregate or window function. This can be omitted for window functions that do not operate over a field such as <code>"count"</code>, <code>"rank"</code>, <code>"dense_rank"</code>.</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>as</td>
        <td>String
</td>
        <td>
  
    <p><strong><em>Required.</em></strong> The output name for the window operation.</p>

  

</td>
      </tr>
    
  </tbody>
</table>

<h3 id="sort-field-def">Sort Field Definition</h3>

<table class="doc-table">
  <thead>
    <tr>
      <th>Property</th>
      <th class="table-column-type">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    
    
    
    
      
      
      <tr>
        <td>field</td>
        <td>String
</td>
        <td>
  
    <p><strong><em>Required.</em></strong> The name of the field to sort.</p>

  

</td>
      </tr>
    
      
      
      <tr>
        <td>order</td>
        <td>String | Null
</td>
        <td>
  
    <p>Whether to sort the field in ascending or descending order. One of <code>"ascending"</code> (default), <code>"descending"</code>, or <code>null</code> (no not sort).</p>

  

</td>
      </tr>
    
  </tbody>
</table>

<h2 id="ops">Window Only Operation Reference</h2>

<p>The valid operations include all <a href="../aggregate/#ops">aggregate operations</a> plus the following window operations.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Operation</th>
      <th style="text-align: center">Parameter</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">row_number</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns each data object a consecutive row number, starting from 1.</td>
    </tr>
    <tr>
      <td style="text-align: left">rank</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns a rank order value to each data object in a window, starting from 1. Peer values are assigned the same rank. Subsequent rank scores incorporate the number of prior values. For example, if the first two values tie for rank 1, the third value is assigned rank 3.</td>
    </tr>
    <tr>
      <td style="text-align: left">dense_rank</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns dense rank order values to each data object in a window, starting from 1. Peer values are assigned the same rank. Subsequent rank scores do not incorporate the number of prior values. For example, if the first two values tie for rank 1, the third value is assigned rank 2.</td>
    </tr>
    <tr>
      <td style="text-align: left">percent_rank</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns a percentage rank order value to each data object in a window. The percent is calculated as <em>(rank - 1) / (group_size - 1)</em>.</td>
    </tr>
    <tr>
      <td style="text-align: left">cume_dist</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns a cumulative distribution value between 0 and 1 to each data object in a window.</td>
    </tr>
    <tr>
      <td style="text-align: left">ntile</td>
      <td style="text-align: center">Number</td>
      <td style="text-align: left">Assigns a quantile (e.g., percentile) value to each data object in a window. Accepts an integer parameter indicating the number of buckets to use (e.g., 100 for percentiles, 5 for quintiles).</td>
    </tr>
    <tr>
      <td style="text-align: left">lag</td>
      <td style="text-align: center">Number</td>
      <td style="text-align: left">Assigns a value from the data object that precedes the current object by a specified number of positions. If no such object exists, assigns <code>null</code>. Accepts an offset parameter (default <code>1</code>) that indicates the number of positions. This operation must have a corresponding entry in the <em>fields</em> parameter array.</td>
    </tr>
    <tr>
      <td style="text-align: left">lead</td>
      <td style="text-align: center">Number</td>
      <td style="text-align: left">Assigns a value from the data object that follows the current object by a specified number of positions. If no such object exists, assigns <code>null</code>. Accepts an offset parameter (default <code>1</code>) that indicates the number of positions. This operation must have a corresponding entry in the <em>fields</em> parameter array.</td>
    </tr>
    <tr>
      <td style="text-align: left">first_value</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns a value from the first data object in the current sliding window frame. This operation must have a corresponding entry in the <em>fields</em> parameter array.</td>
    </tr>
    <tr>
      <td style="text-align: left">last_value</td>
      <td style="text-align: center"><em>None</em></td>
      <td style="text-align: left">Assigns a value from the last data object in the current sliding window frame. This operation must have a corresponding entry in the <em>fields</em> parameter array.</td>
    </tr>
    <tr>
      <td style="text-align: left">nth_value</td>
      <td style="text-align: center">Number</td>
      <td style="text-align: left">Assigns a value from the nth data object in the current sliding window frame. If no such object exists, assigns <code>null</code>. Requires a non-negative integer parameter that indicates the offset from the start of the window frame. This operation must have a corresponding entry in the <em>fields</em> parameter array.</td>
    </tr>
  </tbody>
</table>

<h2 id="examples">Examples</h2>

<p>Below are some common use cases for the window transform.</p>

<h3 id="cumulative-frequency-distribution">Cumulative Frequency Distribution</h3>

<p>Here we use the window transform with <code>frame: [null, 0]</code> to accumulate count in a cumulative frequency distribution plot.</p>

<div class="vl-example" data-name="area_cumulative_freq"></div>

<p><strong>See also:</strong> <a href="../examples/layer_cumulative_histogram.html">layered histogram and cumulative histogram</a></p>

<h3 id="rank-chart">Rank Chart</h3>

<p>We can also use <code>rank</code> operator to calculate ranks over time.</p>

<div class="vl-example" data-name="window_rank"></div>

<h3 id="top-k">Top K</h3>

<p>Here we use window transform to derive the total number of students along with the rank of the current student to determine the top K students and display their score.</p>

<div class="vl-example" data-name="window_top_k"></div>

<p>Also see <a href="https://vega.github.io/vega-lite/examples/window_top_k_others.html">this example</a> for a top-K plot with “others”.</p>

<h3 id="cumulative-running-average">Cumulative Running Average</h3>

<p>Here we use window transform to visualize how the average MPG for vehicles have changed over the years.</p>

<div class="vl-example" data-name="window_cumulative_running_average"></div>

<h2 id="additional-examples">Additional Examples</h2>

<p>These are examples of window transforms that can be simplifies with the join aggregate transform. Please refer to the <a href="joinaggregate.html#examples">join aggregate examples</a>.</p>

<h3 id="percent-of-total">Percent of Total</h3>

<p>You can use the window transform to compute an aggregate and attach it to all records. In this case, you can use the <a href="joinaggregate.html">join aggregate</a> instead of the window transform. Please refer to the <a href="joinaggregate.html#examples">join aggregate examples</a>.</p>

<p>Here we use the window transform to derive the global sum so that we can calculate percentage.</p>

<div class="vl-example" data-name="window_percent_of_total"></div>


  </section>
</div>

  </section>
</div>

<footer>
  <div class="page-centered">
   <span class="edit-page">
      <a href="https://github.com/vega/vega-lite/edit/master/site/docs/transform/window.md">Edit this page</a> and submit a pull request!
    </span>

    <a href="http://idl.cs.washington.edu" title="UW Interactive Data Lab" class="idl-logo"><img src="/vega-lite/static/idl-logo.png"/></a>
  </div>
</footer>

    <script src="/vega-lite/static/bundle.js"></script>
    <script>
      // Google Analytics
      (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        (i[r] =
          i[r] ||
          function() {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'UA-44428446-6', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
